 -- Customers who spent the most amount of money
 
 WITH customer_orders as (select orders."Order_ID", orders."Order_Date", "CustomerName", orders."State", orders."City", "Category",
		"Sub-Category", "Amount", "Quantity", "Payment Mode", "Profit" 
		from orders
		join  "Details" 
		on orders."Order_ID" = "Details"."Order_ID"
)
select distinct("CustomerName") as Customer_Name, sum("Amount") as total_amount_spent
from customer_orders
group by Customer_Name
order by total_amount_spent desc